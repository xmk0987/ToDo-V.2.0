{"ast":null,"code":"import { logout } from \"./logout\";\nconst isAuthenticated = () => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    try {\n      const decodedToken = decodeToken(token);\n      const isTokenValid = decodedToken.exp * 1000 > Date.now();\n      if (decodedToken.admin !== true) {\n        return false;\n      }\n      if (!window.localStorage.username || !window.localStorage.userId) {\n        return false;\n      }\n      return isTokenValid;\n    } catch (error) {\n      logout();\n      return false;\n    }\n  }\n  logout();\n  return false;\n};\nconst decodeToken = token => {\n  return JSON.parse(atob(token.split('.')[1]));\n};\nexport default isAuthenticated;","map":{"version":3,"names":["logout","isAuthenticated","token","localStorage","getItem","decodedToken","decodeToken","isTokenValid","exp","Date","now","admin","window","username","userId","error","JSON","parse","atob","split"],"sources":["/Users/onnivitikainen/Desktop/online-todolist-v2/frontend/src/utils/authentication/adminauth.js"],"sourcesContent":["import { logout } from \"./logout\";\n\nconst isAuthenticated = () => {\n    const token = localStorage.getItem('token');\n  \n    if (token) {\n      try {\n        const decodedToken = decodeToken(token);\n  \n        const isTokenValid = decodedToken.exp * 1000 > Date.now();\n\n        if (decodedToken.admin !== true) {\n          return false;\n        }\n        \n        if(!window.localStorage.username || !window.localStorage.userId) {\n          return false;\n        }\n\n        return isTokenValid;\n      } catch (error) {\n        logout();\n        return false;\n      }\n    }\n    logout(); \n    return false;\n  };\n  \nconst decodeToken = (token) => {\n    return JSON.parse(atob(token.split('.')[1]));\n};\n\nexport default isAuthenticated;"],"mappings":"AAAA,SAASA,MAAM,QAAQ,UAAU;AAEjC,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAC1B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAE3C,IAAIF,KAAK,EAAE;IACT,IAAI;MACF,MAAMG,YAAY,GAAGC,WAAW,CAACJ,KAAK,CAAC;MAEvC,MAAMK,YAAY,GAAGF,YAAY,CAACG,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;MAEzD,IAAIL,YAAY,CAACM,KAAK,KAAK,IAAI,EAAE;QAC/B,OAAO,KAAK;MACd;MAEA,IAAG,CAACC,MAAM,CAACT,YAAY,CAACU,QAAQ,IAAI,CAACD,MAAM,CAACT,YAAY,CAACW,MAAM,EAAE;QAC/D,OAAO,KAAK;MACd;MAEA,OAAOP,YAAY;IACrB,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACdf,MAAM,CAAC,CAAC;MACR,OAAO,KAAK;IACd;EACF;EACAA,MAAM,CAAC,CAAC;EACR,OAAO,KAAK;AACd,CAAC;AAEH,MAAMM,WAAW,GAAIJ,KAAK,IAAK;EAC3B,OAAOc,IAAI,CAACC,KAAK,CAACC,IAAI,CAAChB,KAAK,CAACiB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAChD,CAAC;AAED,eAAelB,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}