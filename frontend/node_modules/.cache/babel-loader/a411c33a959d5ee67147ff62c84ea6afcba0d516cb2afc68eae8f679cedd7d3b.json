{"ast":null,"code":"var _jsxFileName = \"/Users/onnivitikainen/Desktop/online-todolist-v2/frontend/src/components/student/todo/SingleStudentTodo.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useCallback } from \"react\";\nimport { updateTodoComplete } from \"../../../services/student/student\";\nimport { getStudentAnswer, handleStudentAnswer } from \"../../../services/student/studentanswers\";\nimport { getAnswer } from \"../../../services/admin/answers\";\nimport { makeLinksClickable } from \"../../../utils/helperFunctions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SingleStudentTodo = ({\n  todo,\n  onUpdate,\n  baseUrl,\n  token,\n  cheeringFunction\n}) => {\n  _s();\n  const [answer, setAnswer] = useState(null);\n  const [studentAnswer, setStudentAnswer] = useState(null);\n  const [isAnswering, setIsAnswering] = useState(false);\n  const username = window.localStorage.getItem(\"username\");\n  const updateComplete = useCallback(async completed => {\n    try {\n      await updateTodoComplete(baseUrl, token, todo.student_todo_id, completed);\n      onUpdate();\n      if (completed) {\n        cheeringFunction();\n      }\n    } catch (error) {\n      console.error('Error updating todo:', error);\n    }\n  }, [baseUrl, token, todo.student_todo_id, onUpdate, cheeringFunction]);\n  const checkAnswer = useCallback((student = studentAnswer, correct = answer) => {\n    if (student !== null && student && correct && correct.length !== null) {\n      const isCorrect = correct.toLowerCase().trim() === student.toLowerCase().trim();\n      updateComplete(isCorrect);\n      if (!isCorrect) {\n        cheeringFunction(true);\n      }\n      onUpdate();\n    }\n  }, [answer, studentAnswer, updateComplete, onUpdate, cheeringFunction]);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const oldStudentAnswer = await getStudentAnswer(baseUrl, todo.todo_id, username);\n        const correctAnswer = await getAnswer(baseUrl, todo.todo_id);\n        if (correctAnswer.answer) {\n          setAnswer(correctAnswer.answer);\n          if (oldStudentAnswer.student_answer) {\n            setStudentAnswer(oldStudentAnswer.student_answer);\n          }\n        }\n        checkAnswer(oldStudentAnswer.student_answer, correctAnswer.answer);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    };\n    fetchData();\n    //eslint-disable-next-line\n  }, [baseUrl, todo.todo_id, username, token]);\n  useEffect(() => {\n    if (answer !== null && isAnswering) {\n      checkAnswer();\n    }\n    //eslint-disable-next-line\n  }, [answer]);\n  const handleAnswerUpdate = async () => {\n    try {\n      await handleStudentAnswer(baseUrl, token, todo.todo_id, username, studentAnswer);\n      setIsAnswering(false);\n      checkAnswer();\n    } catch (error) {\n      console.error('Error handling student answer:', error);\n    }\n  };\n  const handleQuestion = () => {\n    setIsAnswering(true);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"single-todo-container\",\n    children: isAnswering ? /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      className: \"todo-input\",\n      value: studentAnswer ? studentAnswer : '',\n      placeholder: todo.content,\n      onChange: e => setStudentAnswer(e.target.value),\n      onBlur: handleAnswerUpdate,\n      onKeyDown: e => e.key === \"Enter\" && handleAnswerUpdate(),\n      autoFocus: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: `single-todo-content full-container flex-inline scroll ${todo.completed ? 'make-green' : 'make-red'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `check-mark center-flex`,\n          onClick: () => answer ? checkAnswer() : updateComplete(!todo.completed),\n          children: answer ? /*#__PURE__*/_jsxDEV(\"ion-icon\", {\n            name: \"help-circle-outline\",\n            onClick: handleQuestion\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 25\n          }, this) : todo.completed ? /*#__PURE__*/_jsxDEV(\"ion-icon\", {\n            name: \"checkmark-circle-outline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 25\n          }, this) : /*#__PURE__*/_jsxDEV(\"ion-icon\", {\n            name: \"ellipse-outline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"position\",\n          children: [todo.position, \".\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"scroll\",\n          dangerouslySetInnerHTML: {\n            __html: makeLinksClickable(todo.content)\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `single-todo-menu flex-center`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n};\n_s(SingleStudentTodo, \"G1IhnAFBgjZFeC8e7ZDfTUZ+fyA=\");\n_c = SingleStudentTodo;\nexport default SingleStudentTodo;\nvar _c;\n$RefreshReg$(_c, \"SingleStudentTodo\");","map":{"version":3,"names":["useEffect","useState","useCallback","updateTodoComplete","getStudentAnswer","handleStudentAnswer","getAnswer","makeLinksClickable","jsxDEV","_jsxDEV","Fragment","_Fragment","SingleStudentTodo","todo","onUpdate","baseUrl","token","cheeringFunction","_s","answer","setAnswer","studentAnswer","setStudentAnswer","isAnswering","setIsAnswering","username","window","localStorage","getItem","updateComplete","completed","student_todo_id","error","console","checkAnswer","student","correct","length","isCorrect","toLowerCase","trim","fetchData","oldStudentAnswer","todo_id","correctAnswer","student_answer","handleAnswerUpdate","handleQuestion","className","children","type","value","placeholder","content","onChange","e","target","onBlur","onKeyDown","key","autoFocus","fileName","_jsxFileName","lineNumber","columnNumber","onClick","name","position","dangerouslySetInnerHTML","__html","_c","$RefreshReg$"],"sources":["/Users/onnivitikainen/Desktop/online-todolist-v2/frontend/src/components/student/todo/SingleStudentTodo.js"],"sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\n\nimport { updateTodoComplete } from \"../../../services/student/student\";\nimport { getStudentAnswer, handleStudentAnswer } from \"../../../services/student/studentanswers\";\nimport { getAnswer } from \"../../../services/admin/answers\";\nimport { makeLinksClickable } from \"../../../utils/helperFunctions\";\n\nconst SingleStudentTodo = ({ todo, onUpdate, baseUrl, token, cheeringFunction }) => {\n    const [answer, setAnswer] = useState(null);\n    const [studentAnswer, setStudentAnswer] = useState(null);\n    const [isAnswering, setIsAnswering] = useState(false);\n  \n    const username = window.localStorage.getItem(\"username\");\n  \n    const updateComplete = useCallback(async (completed) => {\n      try {\n        await updateTodoComplete(baseUrl, token, todo.student_todo_id, completed);\n        onUpdate();\n        if (completed) {\n          cheeringFunction();\n        }\n      } catch (error) {\n        console.error('Error updating todo:', error);\n      }\n    }, [baseUrl, token, todo.student_todo_id, onUpdate, cheeringFunction]);\n  \n    const checkAnswer = useCallback((student=studentAnswer, correct=answer) => {\n      if (student !== null && student && correct && correct.length !== null) {\n        \n        const isCorrect = correct.toLowerCase().trim() === student.toLowerCase().trim();\n        updateComplete(isCorrect);\n        if (!isCorrect) {\n          cheeringFunction(true);\n        }\n        onUpdate();\n      }\n    }, [answer, studentAnswer, updateComplete, onUpdate, cheeringFunction]);\n  \n    useEffect(() => {\n      const fetchData = async () => {\n        try {\n          const oldStudentAnswer = await getStudentAnswer(baseUrl, todo.todo_id, username);\n          const correctAnswer = await getAnswer(baseUrl, todo.todo_id);\n  \n          if(correctAnswer.answer) {\n            setAnswer(correctAnswer.answer);\n            if(oldStudentAnswer.student_answer) {\n              setStudentAnswer(oldStudentAnswer.student_answer);\n            }\n          }\n  \n          checkAnswer(oldStudentAnswer.student_answer, correctAnswer.answer);\n  \n        } catch (error) {\n          console.error('Error fetching data:', error);\n        }\n      };\n  \n      fetchData();\n    //eslint-disable-next-line\n    }, [baseUrl, todo.todo_id, username, token]);\n  \n    useEffect(() => {\n      if (answer !== null && isAnswering) {\n        checkAnswer();\n      }\n      //eslint-disable-next-line\n    }, [answer]);\n  \n    const handleAnswerUpdate = async () => {\n      try {\n        await handleStudentAnswer(baseUrl, token, todo.todo_id, username, studentAnswer);\n        setIsAnswering(false);\n        checkAnswer();\n      } catch (error) {\n        console.error('Error handling student answer:', error);\n      }\n    };\n  \n    const handleQuestion = () => {\n      setIsAnswering(true);\n    };\n\n    return (\n        <div className=\"single-todo-container\">\n            {isAnswering ? (\n                <input \n                type=\"text\"\n                className=\"todo-input\"\n                value={studentAnswer ? studentAnswer : ''}\n                placeholder={todo.content}\n                onChange={(e) => setStudentAnswer(e.target.value)}\n                onBlur={handleAnswerUpdate}\n                onKeyDown={(e) => e.key === \"Enter\" && handleAnswerUpdate()}\n                autoFocus\n                />\n            ) :\n            <>\n                <div className={`single-todo-content full-container flex-inline scroll ${todo.completed ? 'make-green' : 'make-red'}`}>\n                    <div className={`check-mark center-flex`} onClick={() => answer ? checkAnswer() : updateComplete(!todo.completed)}>\n                        {answer ? (\n                        <ion-icon name=\"help-circle-outline\" onClick={handleQuestion}></ion-icon>\n                        )  : (todo.completed ? (\n                        <ion-icon name=\"checkmark-circle-outline\"></ion-icon>\n                        ) : (\n                        <ion-icon name=\"ellipse-outline\"></ion-icon>\n                        ))}\n                    </div>\n                    <p className=\"position\">{todo.position}.</p>\n                    <p className=\"scroll\"\n                    dangerouslySetInnerHTML={{ __html: makeLinksClickable(todo.content) }}\n                    />\n                </div>\n                <div className={`single-todo-menu flex-center`}>\n                    \n                </div>\n            </>\n            }\n\n        </div>\n    );\n}\n\n\nexport default SingleStudentTodo;"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AAExD,SAASC,kBAAkB,QAAQ,mCAAmC;AACtE,SAASC,gBAAgB,EAAEC,mBAAmB,QAAQ,0CAA0C;AAChG,SAASC,SAAS,QAAQ,iCAAiC;AAC3D,SAASC,kBAAkB,QAAQ,gCAAgC;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAEpE,MAAMC,iBAAiB,GAAGA,CAAC;EAAEC,IAAI;EAAEC,QAAQ;EAAEC,OAAO;EAAEC,KAAK;EAAEC;AAAiB,CAAC,KAAK;EAAAC,EAAA;EAChF,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACoB,aAAa,EAAEC,gBAAgB,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACsB,WAAW,EAAEC,cAAc,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC;EAErD,MAAMwB,QAAQ,GAAGC,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;EAExD,MAAMC,cAAc,GAAG3B,WAAW,CAAC,MAAO4B,SAAS,IAAK;IACtD,IAAI;MACF,MAAM3B,kBAAkB,CAACY,OAAO,EAAEC,KAAK,EAAEH,IAAI,CAACkB,eAAe,EAAED,SAAS,CAAC;MACzEhB,QAAQ,CAAC,CAAC;MACV,IAAIgB,SAAS,EAAE;QACbb,gBAAgB,CAAC,CAAC;MACpB;IACF,CAAC,CAAC,OAAOe,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC9C;EACF,CAAC,EAAE,CAACjB,OAAO,EAAEC,KAAK,EAAEH,IAAI,CAACkB,eAAe,EAAEjB,QAAQ,EAAEG,gBAAgB,CAAC,CAAC;EAEtE,MAAMiB,WAAW,GAAGhC,WAAW,CAAC,CAACiC,OAAO,GAACd,aAAa,EAAEe,OAAO,GAACjB,MAAM,KAAK;IACzE,IAAIgB,OAAO,KAAK,IAAI,IAAIA,OAAO,IAAIC,OAAO,IAAIA,OAAO,CAACC,MAAM,KAAK,IAAI,EAAE;MAErE,MAAMC,SAAS,GAAGF,OAAO,CAACG,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,KAAKL,OAAO,CAACI,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;MAC/EX,cAAc,CAACS,SAAS,CAAC;MACzB,IAAI,CAACA,SAAS,EAAE;QACdrB,gBAAgB,CAAC,IAAI,CAAC;MACxB;MACAH,QAAQ,CAAC,CAAC;IACZ;EACF,CAAC,EAAE,CAACK,MAAM,EAAEE,aAAa,EAAEQ,cAAc,EAAEf,QAAQ,EAAEG,gBAAgB,CAAC,CAAC;EAEvEjB,SAAS,CAAC,MAAM;IACd,MAAMyC,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMC,gBAAgB,GAAG,MAAMtC,gBAAgB,CAACW,OAAO,EAAEF,IAAI,CAAC8B,OAAO,EAAElB,QAAQ,CAAC;QAChF,MAAMmB,aAAa,GAAG,MAAMtC,SAAS,CAACS,OAAO,EAAEF,IAAI,CAAC8B,OAAO,CAAC;QAE5D,IAAGC,aAAa,CAACzB,MAAM,EAAE;UACvBC,SAAS,CAACwB,aAAa,CAACzB,MAAM,CAAC;UAC/B,IAAGuB,gBAAgB,CAACG,cAAc,EAAE;YAClCvB,gBAAgB,CAACoB,gBAAgB,CAACG,cAAc,CAAC;UACnD;QACF;QAEAX,WAAW,CAACQ,gBAAgB,CAACG,cAAc,EAAED,aAAa,CAACzB,MAAM,CAAC;MAEpE,CAAC,CAAC,OAAOa,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC9C;IACF,CAAC;IAEDS,SAAS,CAAC,CAAC;IACb;EACA,CAAC,EAAE,CAAC1B,OAAO,EAAEF,IAAI,CAAC8B,OAAO,EAAElB,QAAQ,EAAET,KAAK,CAAC,CAAC;EAE5ChB,SAAS,CAAC,MAAM;IACd,IAAImB,MAAM,KAAK,IAAI,IAAII,WAAW,EAAE;MAClCW,WAAW,CAAC,CAAC;IACf;IACA;EACF,CAAC,EAAE,CAACf,MAAM,CAAC,CAAC;EAEZ,MAAM2B,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACrC,IAAI;MACF,MAAMzC,mBAAmB,CAACU,OAAO,EAAEC,KAAK,EAAEH,IAAI,CAAC8B,OAAO,EAAElB,QAAQ,EAAEJ,aAAa,CAAC;MAChFG,cAAc,CAAC,KAAK,CAAC;MACrBU,WAAW,CAAC,CAAC;IACf,CAAC,CAAC,OAAOF,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACxD;EACF,CAAC;EAED,MAAMe,cAAc,GAAGA,CAAA,KAAM;IAC3BvB,cAAc,CAAC,IAAI,CAAC;EACtB,CAAC;EAED,oBACIf,OAAA;IAAKuC,SAAS,EAAC,uBAAuB;IAAAC,QAAA,EACjC1B,WAAW,gBACRd,OAAA;MACAyC,IAAI,EAAC,MAAM;MACXF,SAAS,EAAC,YAAY;MACtBG,KAAK,EAAE9B,aAAa,GAAGA,aAAa,GAAG,EAAG;MAC1C+B,WAAW,EAAEvC,IAAI,CAACwC,OAAQ;MAC1BC,QAAQ,EAAGC,CAAC,IAAKjC,gBAAgB,CAACiC,CAAC,CAACC,MAAM,CAACL,KAAK,CAAE;MAClDM,MAAM,EAAEX,kBAAmB;MAC3BY,SAAS,EAAGH,CAAC,IAAKA,CAAC,CAACI,GAAG,KAAK,OAAO,IAAIb,kBAAkB,CAAC,CAAE;MAC5Dc,SAAS;IAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACR,CAAC,gBAENvD,OAAA,CAAAE,SAAA;MAAAsC,QAAA,gBACIxC,OAAA;QAAKuC,SAAS,EAAG,yDAAwDnC,IAAI,CAACiB,SAAS,GAAG,YAAY,GAAG,UAAW,EAAE;QAAAmB,QAAA,gBAClHxC,OAAA;UAAKuC,SAAS,EAAG,wBAAwB;UAACiB,OAAO,EAAEA,CAAA,KAAM9C,MAAM,GAAGe,WAAW,CAAC,CAAC,GAAGL,cAAc,CAAC,CAAChB,IAAI,CAACiB,SAAS,CAAE;UAAAmB,QAAA,EAC7G9B,MAAM,gBACPV,OAAA;YAAUyD,IAAI,EAAC,qBAAqB;YAACD,OAAO,EAAElB;UAAe;YAAAc,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAW,CAAC,GACnEnD,IAAI,CAACiB,SAAS,gBACpBrB,OAAA;YAAUyD,IAAI,EAAC;UAA0B;YAAAL,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAW,CAAC,gBAErDvD,OAAA;YAAUyD,IAAI,EAAC;UAAiB;YAAAL,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAW;QACzC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC,eACNvD,OAAA;UAAGuC,SAAS,EAAC,UAAU;UAAAC,QAAA,GAAEpC,IAAI,CAACsD,QAAQ,EAAC,GAAC;QAAA;UAAAN,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eAC5CvD,OAAA;UAAGuC,SAAS,EAAC,QAAQ;UACrBoB,uBAAuB,EAAE;YAAEC,MAAM,EAAE9D,kBAAkB,CAACM,IAAI,CAACwC,OAAO;UAAE;QAAE;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eACNvD,OAAA;QAAKuC,SAAS,EAAG;MAA8B;QAAAa,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAE1C,CAAC;IAAA,eACR;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAGF,CAAC;AAEd,CAAC;AAAA9C,EAAA,CAlHKN,iBAAiB;AAAA0D,EAAA,GAAjB1D,iBAAiB;AAqHvB,eAAeA,iBAAiB;AAAC,IAAA0D,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}