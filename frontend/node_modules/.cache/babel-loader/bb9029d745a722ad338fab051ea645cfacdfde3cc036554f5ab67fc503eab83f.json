{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState, useCallback, useEffect, useRef } from \"react\";\nimport { useBaseUrl } from \"../../utils/providers/urlprovider\";\nimport { getTodos, updatePosition } from \"../../services/admin/todos/todos\";\nimport { formattedDate } from \"../../utils/helperFunctions\";\nimport TodoCardOptions from \"../../services/admin/todos/TodoOptions\";\nimport AddTodoView from \"./AddTodoView\";\nimport SingleTodo from \"./SingleTodo\";\nconst TodoCard = ({\n  cardItem,\n  getAllClasses,\n  shareView = false,\n  widthSize\n}) => {\n  _s();\n  const [todos, setTodos] = useState([]);\n  const [addingTodo, setAddingTodo] = useState(false);\n  const [dragOverItem, setDragOverItem] = useState(null);\n  const changeAddingStatus = () => {\n    setAddingTodo(!addingTodo);\n  };\n  const baseURL = useBaseUrl();\n  const token = window.localStorage.getItem(\"token\");\n  const getAllTodos = useCallback(async () => {\n    try {\n      const result = await getTodos(baseURL, token, cardItem.class_id);\n      setTodos(result);\n    } catch (error) {\n      console.error(\"Error fetching todos:\", error);\n    }\n  }, [baseURL, token, cardItem.class_id]);\n  const firstTodo = useRef(null);\n  const secondTodo = useRef(null);\n  const sortedTodos = [...todos].sort((a, b) => a.position - b.position);\n  const handleDragEnd = async () => {\n    const todo1 = sortedTodos[firstTodo.current];\n    const todo2 = sortedTodos[secondTodo.current];\n    await updatePosition(baseURL, token, todo1, todo2);\n    const updateEvent = new CustomEvent(\"updateEvent\", {\n      detail: {\n        source: \"TodoCard\"\n      }\n    });\n    window.dispatchEvent(updateEvent);\n    getAllTodos();\n    firstTodo.current = null;\n    secondTodo.current = null;\n    setDragOverItem(null);\n  };\n  useEffect(() => {\n    console.log(\"täs\");\n    console.log(cardItem);\n    getAllTodos();\n  }, [cardItem.class_id, getAllTodos]);\n  return {\n    cardItem\n  };\n};\n_s(TodoCard, \"QaudtyMnxzYdmNoZshNtfWLC53Q=\", false, function () {\n  return [useBaseUrl];\n});\n_c = TodoCard;\nexport default TodoCard;\nvar _c;\n$RefreshReg$(_c, \"TodoCard\");","map":{"version":3,"names":["React","useState","useCallback","useEffect","useRef","useBaseUrl","getTodos","updatePosition","formattedDate","TodoCardOptions","AddTodoView","SingleTodo","TodoCard","cardItem","getAllClasses","shareView","widthSize","_s","todos","setTodos","addingTodo","setAddingTodo","dragOverItem","setDragOverItem","changeAddingStatus","baseURL","token","window","localStorage","getItem","getAllTodos","result","class_id","error","console","firstTodo","secondTodo","sortedTodos","sort","a","b","position","handleDragEnd","todo1","current","todo2","updateEvent","CustomEvent","detail","source","dispatchEvent","log","_c","$RefreshReg$"],"sources":["/Users/onnivitikainen/Desktop/online-todolist-v2/frontend/src/components/todo/TodoCard.js"],"sourcesContent":["import React, { useState, useCallback, useEffect, useRef } from \"react\";\n\nimport { useBaseUrl } from \"../../utils/providers/urlprovider\";\n\nimport { getTodos, updatePosition } from \"../../services/admin/todos/todos\";\nimport { formattedDate } from \"../../utils/helperFunctions\";\n\nimport TodoCardOptions from \"../../services/admin/todos/TodoOptions\";\nimport AddTodoView from \"./AddTodoView\";\nimport SingleTodo from \"./SingleTodo\";\n\nconst TodoCard = ({ cardItem, getAllClasses, shareView = false, widthSize }) => {\n  const [todos, setTodos] = useState([]);\n  const [addingTodo, setAddingTodo] = useState(false);\n  const [dragOverItem, setDragOverItem] = useState(null);\n\n  const changeAddingStatus = () => {\n    setAddingTodo(!addingTodo);\n  };\n\n  const baseURL = useBaseUrl();\n  const token = window.localStorage.getItem(\"token\");\n\n  const getAllTodos = useCallback(async () => {\n    try {\n      const result = await getTodos(baseURL, token, cardItem.class_id);\n      setTodos(result);\n    } catch (error) {\n      console.error(\"Error fetching todos:\", error);\n    }\n  },[baseURL, token, cardItem.class_id]);\n\n  const firstTodo = useRef(null);\n  const secondTodo = useRef(null);\n\n  const sortedTodos = [...todos].sort((a, b) => a.position - b.position);\n\n  const handleDragEnd = async () => {\n      const todo1 = sortedTodos[firstTodo.current];\n      const todo2 = sortedTodos[secondTodo.current];\n\n      await updatePosition(baseURL, token, todo1, todo2);\n\n      const updateEvent = new CustomEvent(\"updateEvent\", { detail: { source: \"TodoCard\" } });\n      window.dispatchEvent(updateEvent);\n\n      getAllTodos();\n\n      firstTodo.current = null;\n      secondTodo.current = null;\n      setDragOverItem(null); \n  };\n\n  useEffect(() => {\n    console.log(\"täs\");\n    console.log(cardItem);\n    getAllTodos();\n  }, [cardItem.class_id, getAllTodos]);\n\n\n  \n  return (\n    {cardItem }\n  );\n};\n\n\n\nexport default TodoCard;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}