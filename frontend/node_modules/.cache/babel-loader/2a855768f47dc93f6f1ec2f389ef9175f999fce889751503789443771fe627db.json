{"ast":null,"code":"import { studentLogout } from \"./logout\";\nconst isStudentAuthenticated = async () => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    try {\n      const decodedToken = decodeToken(token);\n      const isTokenValid = decodedToken.exp * 1000 > Date.now();\n      if (decodedToken.admin !== false) {\n        return false;\n      }\n      if (!window.localStorage.username || !window.localStorage.classroom_name) {\n        return false;\n      }\n      return isTokenValid;\n    } catch (error) {\n      studentLogout();\n      return false;\n    }\n  }\n  studentLogout();\n  return false;\n};\nconst decodeToken = token => {\n  return JSON.parse(atob(token.split('.')[1]));\n};\nexport default isStudentAuthenticated;","map":{"version":3,"names":["studentLogout","isStudentAuthenticated","token","localStorage","getItem","decodedToken","decodeToken","isTokenValid","exp","Date","now","admin","window","username","classroom_name","error","JSON","parse","atob","split"],"sources":["/Users/onnivitikainen/Desktop/online-todolist-v2/frontend/src/utils/authentication/studentAuthentication.js"],"sourcesContent":["import { studentLogout } from \"./logout\";\n\nconst isStudentAuthenticated = async () => {\n    const token = localStorage.getItem('token');\n  \n    if (token) {\n      try {\n        const decodedToken = decodeToken(token);\n  \n        const isTokenValid = decodedToken.exp * 1000 > Date.now();\n\n        if (decodedToken.admin !== false) {\n          return false;\n        }\n\n        if(!window.localStorage.username || !window.localStorage.classroom_name) {\n          return false;\n        }\n\n        return isTokenValid;\n      } catch (error) {\n        studentLogout();\n        return false;\n      }\n    }\n    studentLogout(); \n    return false;\n  };\n  \nconst decodeToken = (token) => {\n    return JSON.parse(atob(token.split('.')[1]));\n};\n\nexport default isStudentAuthenticated;"],"mappings":"AAAA,SAASA,aAAa,QAAQ,UAAU;AAExC,MAAMC,sBAAsB,GAAG,MAAAA,CAAA,KAAY;EACvC,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAE3C,IAAIF,KAAK,EAAE;IACT,IAAI;MACF,MAAMG,YAAY,GAAGC,WAAW,CAACJ,KAAK,CAAC;MAEvC,MAAMK,YAAY,GAAGF,YAAY,CAACG,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;MAEzD,IAAIL,YAAY,CAACM,KAAK,KAAK,KAAK,EAAE;QAChC,OAAO,KAAK;MACd;MAEA,IAAG,CAACC,MAAM,CAACT,YAAY,CAACU,QAAQ,IAAI,CAACD,MAAM,CAACT,YAAY,CAACW,cAAc,EAAE;QACvE,OAAO,KAAK;MACd;MAEA,OAAOP,YAAY;IACrB,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACdf,aAAa,CAAC,CAAC;MACf,OAAO,KAAK;IACd;EACF;EACAA,aAAa,CAAC,CAAC;EACf,OAAO,KAAK;AACd,CAAC;AAEH,MAAMM,WAAW,GAAIJ,KAAK,IAAK;EAC3B,OAAOc,IAAI,CAACC,KAAK,CAACC,IAAI,CAAChB,KAAK,CAACiB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAChD,CAAC;AAED,eAAelB,sBAAsB"},"metadata":{},"sourceType":"module","externalDependencies":[]}